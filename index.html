<!DOCTYPE html>
<html>
    <head>
        
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
        <link rel="stylesheet" type="text/css" href="style.css">
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
        
        <title>A JSON Viewer</title>
        
        <script>
            
            //TDOD http://jsfiddle.net/uenZW/2/
            //TODO get json link from url in input field
            
            var leftGlobalID = "";
            var rightGlobalID = "";
            var globalDATA;
            var resultRight;
            
            $(document).ready(function() {
                
                function isArray(what) {
                    return Object.prototype.toString.call(what) === '[object Array]';
                }         
                function hasAddress(index) {
                    if(data[index].hasOwnProperty('address')){
                        return true;
                    }
                }
                function hasConnectivity(index) {
                    if(data[index].hasOwnProperty('connectivity')){
                        return true;
                    }
                }
                function hasVideos(index) {
                    if(data[index].hasOwnProperty('videos')){
                        return true;
                    }
                }
                function hasLogo(index) {
                    if(data[index].hasOwnProperty('logo')){
                        return true;
                    }
                }
                function hasAwards(index) {
                    if(data[index].hasOwnProperty('awards')){
                        return true;
                    }
                }
                
                $.getJSON("https://cors-anywhere.herokuapp.com/http://mindpower.com/index.cfm/contacts",function(data){
                    console.log("GET: json from mindpower successfully!");
                    globalDATA = data;
                    for (i in data) {
                        $("#listKey").append($("<li class='listItemLeft leftList' id='" + data[i].alias + "'>").text(data[i].alias));
                    }
                    console.log("SET: json keys to listKey successfully!");
                });
                
                
                function findObjects(obj, targetProp, targetValue, finalResults) {

                    function getObject(theObject) {
                        let result = null;
                        if (theObject instanceof Array) {
                            for (let i = 0; i < theObject.length; i++) {
                                getObject(theObject[i]);
                            }
                        } else {
                            for (let prop in theObject) {
                                if (theObject.hasOwnProperty(prop)) {
                                    console.log(prop + ': ' + theObject[prop]);
                                    if (prop === targetProp) {
                                        console.log('found alias');
                                        if (theObject[prop] === targetValue) {
                                            console.log('found prop', prop, ': ', theObject[prop]);
                                            finalResults.push(theObject);
                                        }
                                    }
                                    if (theObject[prop] instanceof Object || theObject[prop] instanceof Array) {
                                        getObject(theObject[prop]);
                                    }
                                }
                            }
                        }
                    }
                    getObject(obj);
                }
                
                function findObjects1(obj) {

                    function getObject(theObject) {
                        let result = null;
                        if (theObject instanceof Array) {
                            for (let i = 0; i < theObject.length; i++) {
                                getObject(theObject[i]);
                            }
                        } else {
                            for (let prop in theObject) {
                                if (theObject.hasOwnProperty(prop)) {
                                    $("#listArray").append($("<li class='listItemRight' id='" + prop + "'>").text(prop));
                                }
                            }
                        }
                    }
                    getObject(obj);
                }
                
                function findObjects2(obj, targetProp) {

                    function getObject(theObject) {
                        let result = null;
                        if (theObject instanceof Array) {
                            for (let i = 0; i < theObject.length; i++) {
                                getObject(theObject[i]);
                            }
                        } else {
                            for (let prop in theObject) {
                                console.log(prop + ': ' + theObject[prop]);
                                if (theObject.hasOwnProperty(prop)) {
                                    if (prop === targetProp) {
                                        $("#listEdit ul").append($("<h3 id'titelForTextbox' style='right:0;margin-right: 10px; text-align: center'></h3>").text(prop + ": ").append($("<input id='" + prop + "' class='listItemBottom' style='height: 35px;width: 70%;margin: 10px 10px;border: 3px solid lightslategrey;padding-left: 3px;font-size: 15px;'> <br>").val(theObject[prop])));
                                    }
                                    if (theObject[prop] instanceof Object || theObject[prop] instanceof Array) {
                                        getObject(theObject[prop]);
                                    }
                                }
                            }
                        }
                    }
                    getObject(obj);
                }
                

                var finalResults = [];
                var finalResultsForList = [];
                var result = [];
                
                $(document).on('click', '.listItemLeft', function () {
                    $('#listArray').empty();
                    leftGlobalID = this.id;
                    findObjects(globalDATA, "alias", leftGlobalID, finalResults);
                    findObjects1(finalResults);
                    
                    //reset value
                    finalResultsForList = finalResults;
                    finalResults = [];
                });
                
                $(document).on('click', '.listItemRight', function () {
                    //$('#listEdit').empty();
                    rightGlobalID = this.id;
                    console.log('right ID: ' + this.id);
                    findObjects(finalResultsForList, rightGlobalID, rightGlobalID, finalResultsForList);
                    console.log(finalResultsForList);
                    findObjects2(finalResultsForList, rightGlobalID);
                });
                
                $(document).on('click', '.listItemBottom', function () {
                    if(this.id == "birthdate"){
                        //$('#birthdate').attr('pattern', "20[0-9][0-9]-((0[1-9])|(1[0-2]))-(([1-2][0-9])|(3[0-1])|(0[1-9]))");
                        //$('.listItemBottom').datepicker().datepicker("show");
                    }
                });
                
            });
            
        </script>
        
    </head>
    <body>

        <div class="box">
            <img style="vertical-align:middle; height: auto; width: 45px;" src="jsonTitel.png">
            <span style="">JSON Viewer</span>
        </div>
        
        <div class="flex_container">
            <div class="flex_box_25">
            </div>
            <div class="flex_box_50">
               <div class="topMenu">
                   <form>
                       <span style="padding-left: 75%;" class="columnTitel"><b>1.</b> Request a JSON</span>
                       <div class="btn-group">
                           <input style="height: 40px;width: 47%;margin:0px 0px 10px 10px;border: 3px solid lightslategrey;padding-left: 3px;font-size: 25px;">
                           <button>Request JSON&nbsp;<i class="fas fa-angle-double-right"></i></button>
                       </div>
                   </form>
                </div> 
            </div>
            <div class="flex_box_25">
            </div>
        </div>
        
        <div class="flex_container">
            <div class="flex_box_25">
            </div>
            <div class="flex_box_25">
                <span class="columnTitel"><b>2.</b> Select dataset</span>
                <div class="sidesMenu">
                    <ul id="listKey">
                    </ul>
                </div>
            </div>
            <div class="flex_box_25">
                <span class="columnTitel"><b>3.</b> Attribute KEY</span>
                <div class="sidesMenu">
                    <ul id="listArray">
                    </ul>
                </div>
            </div>
            <div class="flex_box_25">
            </div>
        </div>

        <div class="flex_container">
            <div class="flex_box_25">
            </div>
            <div class="flex_box_501">
                <span class="columnTitel"><b>4.</b> Edit content</span>
                <div style="margin-top: 10px" id="listEdit" class="bottomMenu">

                    <form>
                        <ul>
                        </ul>
                        <span style="padding-left: 75%;" class="columnTitel"><b>5.</b> Send changes</span>
                        <div class="btn-group">
                            <button>Send&nbsp;<i class="fas fa-angle-double-right"></i></button>
                            <button>Reset&nbsp;<i class="fas fa-ban"></i></button>
                        </div>
                   </form>
                    
                </div> 
            </div>
            <div class="flex_box_25">
            </div>
        </div>

        <h4>Leroy &copy;<br>by using this website you agree to give me a high five opon request</h4>

    </body>
</html>